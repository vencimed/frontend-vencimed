<div class="drawer-content">
  
  <div class="drawer-header">
    <div class="header-title-wrapper">
      <img src="/assets/icones/cesta.svg" alt="Cesta">
      <h2 class="header-title">Minha Cesta</h2>
      <ng-container *ngIf="(totalItems$ | async) as total">
        <span *ngIf="total > 0" class="header-badge">
          ({{ total }})
        </span>
      </ng-container>
    </div>
    <button (click)="onClose()" class="close-button">
      <lucide-icon name="x" [size]="20"></lucide-icon>
    </button>
  </div>

  <div class="drawer-body">
    
    <div *ngIf="isEmpty; else itemsList" class="empty-state">
      <div class="empty-icon-wrapper">
        <lucide-icon name="shopping-cart" [size]="40" class="empty-icon"></lucide-icon>
      </div>
      <h3 class="empty-title">Seu carrinho est√° vazio.</h3>
      <p class="empty-subtitle">
        Que tal aproveitar nossas ofertas do dia?
      </p>
      <button (click)="onClose()" class="continue-button outline">
        Continuar comprando
      </button>
    </div>

    <ng-template #itemsList>
      <div *ngIf="(cartItems$ | async) as items" class="items-list">
        
        <div *ngFor="let item of items" class="item-card">
          <div class="item-image-wrapper">
            <img [src]="item.image" [alt]="item.name" class="item-image" />
          </div>

          <div class="item-info">
            <p class="item-brand">{{ item.brand }}</p>
            <h4 class="item-name">{{ item.name }}</h4>
            <div class="item-price-wrapper">
              <span class="item-price-discount">R$ {{ item.discountPrice.toFixed(2) }}</span>
              <span class="item-price-original">R$ {{ item.originalPrice.toFixed(2) }}</span>
            </div>
          </div>

          <div class="item-actions">
            <button (click)="onRemoveItem(item.id)" class="remove-button">
              <lucide-icon name="trash-2" [size]="20"></lucide-icon>
            </button>
              
            <div class="quantity-options">
              <button type="button" (click)="onDecreaseQuantity(item.id)">-</button>
              <span>{{ item.quantity }}</span>
              <button type="button" (click)="onIncreaseQuantity(item.id)">+</button>
            </div>
            <!-- <mat-select 
              [value]="item.quantity" 
              (selectionChange)="onUpdateQuantity(item.id, $event)" 
              class="quantity-select">
              <mat-option *ngFor="let num of quantityOptions" [value]="num">
                {{ num }}
              </mat-option> 
            </mat-select>-->
          </div>
        </div>
        
      </div>
    </ng-template>
  </div>

  <div *ngIf="!isEmpty" class="drawer-footer">
    <div class="subtotal-wrapper">
      <span>Subtotal</span>
      <span *ngIf="(subtotal$ | async) as subtotal" class="subtotal-price">
        R$ {{ subtotal.toFixed(2) }}
      </span>
    </div>
    <div class="footer-buttons">
      <button (click)="onGoToCart()" class="continue-button primary">
        Prosseguir
      </button>
      <button (click)="onClose()" class="continue-button outline">
        Continuar comprando
      </button>
    </div>
  </div>
</div>