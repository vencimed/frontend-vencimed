<div class="admin-layout">
  <!-- Sidebar -->
  <aside class="admin-sidebar">
    <!-- Logo -->
    <div class="sidebar-header">
      <div class="sidebar-logo-icon">
        <span>V</span>
      </div>
      <div class="sidebar-logo-text">
        <h1>VCM Pharma</h1>
        <p>Admin Panel</p>
      </div>
    </div>

    <!-- Navegação -->
    <nav class="sidebar-nav">
      <button
        *ngFor="let item of sidebarItems"
        class="sidebar-item"
        [ngClass]="{ 'sidebar-item--active': item.active }"
      >
        <span class="sidebar-item__icon">{{ item.icon }}</span>
        <span class="sidebar-item__label">{{ item.label }}</span>
      </button>
    </nav>

    <!-- Usuário -->
    <div class="sidebar-user">
      <div class="sidebar-user-avatar">AD</div>
      <div class="sidebar-user-info">
        <p class="sidebar-user-name">Admin</p>
        <p class="sidebar-user-email">admin@vcm.com</p>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <div class="admin-main">
    <!-- Topbar -->
    <header class="admin-topbar">
      <div>
        <h2>Dashboard</h2>
        <p>Bem-vindo de volta!</p>
      </div>
      <div class="topbar-date">
        {{ todayLabel }}
      </div>
    </header>

    <!-- Conteúdo -->
    <main class="admin-content">
      <!-- Cards métricas -->
      <section class="metrics-grid">
        <article
          *ngFor="let metric of metrics"
          class="metric-card"
        >
          <div class="metric-card-header">
            <div class="metric-icon-wrapper">
              <span class="metric-icon">{{ metric.icon }}</span>
            </div>
            <span
              class="metric-badge"
              [ngClass]="{
                'metric-badge--up': metric.trend === 'up',
                'metric-badge--down': metric.trend === 'down',
                'metric-badge--warning': metric.trend === 'warning'
              }"
            >
              {{ metric.change }}
            </span>
          </div>
          <p class="metric-title">{{ metric.title }}</p>
          <p class="metric-value">{{ metric.value }}</p>
        </article>
      </section>

      <!-- Linha de gráficos -->
      <section class="charts-row">
        <!-- Gráfico de vendas (fake bar chart com divs) -->
        <article class="chart-card chart-card--wide">
          <h3>Vendas Mensais</h3>

          <div class="bar-chart">
            <div
              class="bar-chart-item"
              *ngFor="let point of salesData"
            >
              <div
                class="bar-chart-bar"
                [style.height.%]="barHeight(point.vendas)"
              ></div>
              <span class="bar-chart-label">{{ point.name }}</span>
            </div>
          </div>
        </article>

        <!-- Gráfico de pizza simples -->
        <article class="chart-card">
          <h3>Por Categoria</h3>

          <div class="pie-chart">
            <div class="pie-chart-legend">
              <div
                class="pie-chart-legend-item"
                *ngFor="let cat of categoryData"
              >
                <span
                  class="legend-color"
                  [style.background-color]="cat.color"
                ></span>
                <span class="legend-label">
                  {{ cat.name }} – {{ cat.value }}%
                </span>
              </div>
            </div>
          </div>
        </article>
      </section>

      <!-- Status de integrações -->
      <section class="card integrations-card">
        <h3>Status de Integrações</h3>

        <div class="integrations-grid">
          <div
            class="integration-item"
            *ngFor="let integration of integrations"
          >
            <span class="integration-name">{{ integration.name }}</span>
            <span
              class="integration-badge"
              [ngClass]="{
                'integration-badge--online':
                  integration.status === 'online',
                'integration-badge--unstable':
                  integration.status === 'unstable'
              }"
            >
              {{ integration.status === 'online' ? 'Online' : 'Instável' }}
            </span>
          </div>
        </div>
      </section>

      <!-- Tabela de produtos próximos ao vencimento -->
      <section class="card">
        <div class="expiring-header">
          <div>
            <h3>Produtos Próximos ao Vencimento</h3>
          </div>

          <div class="expiring-actions">
            <div class="expiring-toggle">
              <button
                class="toggle-btn"
                [ngClass]="{ 'toggle-btn--active': filterPeriod === '7days' }"
                (click)="setFilterPeriod('7days')"
              >
                Últimos 7 dias
              </button>
              <button
                class="toggle-btn"
                [ngClass]="{ 'toggle-btn--active': filterPeriod === '30days' }"
                (click)="setFilterPeriod('30days')"
              >
                Até 30 dias
              </button>
            </div>

            <button class="export-btn">
              ⬇ Exportar CSV
            </button>
          </div>
        </div>

        <div class="table-wrapper">
          <table class="expiring-table">
            <thead>
              <tr>
                <th>Produto</th>
                <th>Lote</th>
                <th>Quantidade</th>
                <th>Vencimento</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of expiringProducts">
                <td>{{ product.name }}</td>
                <td>{{ product.batch }}</td>
                <td>{{ product.quantity }}</td>
                <td>{{ product.expiry }}</td>
                <td>
                  <span
                    class="status-pill"
                    [ngClass]="{
                      'status-pill--critical':
                        product.status === 'critical',
                      'status-pill--warning':
                        product.status === 'warning'
                    }"
                  >
                    {{
                      product.status === 'critical'
                        ? 'Crítico'
                        : 'Atenção'
                    }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
  </div>
</div>
